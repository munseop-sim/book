# chapter06. 메시지와 인터페이스

유연하고 재사용 가능한 퍼블릭 인터페이스를 만드는데 도움이 되는 설계원칙과 원칙,기법에 대한 설명

### 인터페이스, 설계품질

좋은 인터페이스 = 최소한의 인터페이스 + 추상적인 인터페이스 → 책임주도설계방법

- 최소한의 인터페이스 : 꼭 필요한 오퍼레이션만 인터페이스에 포함
- 추상적인 인터페이스 : How보다 What에 집중

### 용어정리

메시지 : 객체가 다른 객체와 협력하기 위해 사용하는 의사소통 메커니즘.

오퍼레이션 : 객체가 다른객체에게 제공하는 추상적인 서비스

메서드 : 메시지에 응답하기 위해 실행되는 코드블록, 오퍼레이션의 구현

퍼블릭 인터페이스 : 객체가 협력에 참여하기 위해 외부에서 수신할 수 있는 메시지의 묶음. 클래스의 퍼블릭 메서드들의 집합이나 메시지의 집합을 가리키는데 사용됨. 객체를 설계할 때 가장 중요한 것은 훌룡한 퍼블릭 인터페이스를 설계하는 것.

시그니처 : 시그니처는 오퍼레이션이나 메서드의 명세를 나타낸 것으로, 이름과 인자의 목록을 포함한다. 대부분의 언어는 시그니처의 일부로 반환 타입을 포함하지 않지만 반환 타입을 시그니처의 빌부로 포함하는 언어도 존재한다.

### 퍼블릭인터페이스 품질에 영향을 미치는 원칙

1. 디미터 법칙(Law Of Demeter)
    1. 협력하는 객체의 내부구조에 대한 결합으로 인해 발생하는 설계문제를 해결하기 위해 제안된 원칙이고 캡슐화를 다른 관점에서 표현한 것
    2. 원칙 : 객체의 내부구조에 강하게 결합되지 않도록 협력경로 제한
    3. 객체가 자기 자신을 책임지는 자율적인 존재여야 한다는 사실을 강조
    4. 클래스가 특정한 조건을 만족하는 대상에게만 메시지를 전송하도록 개발해야함
    5. 아래 조건을 만족하는 인스턴스에만 메시지 전송해야함
        1. this 객체
        2. 메서더의 매개변수(파라미터)
        3. this 속성
        4. this의속성인 컬렉션의 요소
        5. 메서드내에서 생성된 지역객체
    6. 디미터 법칙을 따르면 shy code 작성가능
        1. shy code : 불필요한 어떤것도 다른객체에게 보여주지 않으며, 다른 객체의 구현에 의존하지 않는 코드
    7. 디미버 법칙을 따르지 않는 코드
        1. screening.getMovie().getDiscountCondtions() → 기차충돌 (train wreck) 코드
    8. 단점 : 퍼블릭인터페이스 관점에서 객체의 응집도가 낮아질수 있다.
2. 묻지말고시켜라 (Tell, Don’t Ask)
    1. ‘객체의 상태에 관해 묻지말고 원하는것을 시켜야한다’는 스타일의 메세지 작성을 장려하는 원칙을 가리키는 용어
    2. 원칙을 따르면 밀정합게 연관된 정보와 행동을 함께 가지는 객체를 만들 수 있다. → 자연스럽게 정보전문가에게 책임을 할당하게되고 높은 응집도를 가진 클래스를 얻을 확률이 높아진다.
    3. 협력을 설계하고 객체가 수신할 메시지를 결정하는 매 순간 **‘묻지 말고 시켜라’**원칙과 **디미터법칙**을 머릿속에 떠올리는 것은 퍼블릭 인터페이스의 품질을 향상시킬수 있는 좋은 습관이다.
3. 의도를 드러내는 인터페이스(Intetion Revealing Interface)
    1. ‘어떻게’가 아니라 ‘무엇’을 하는지 드러내도록 네이밍을 한다.
    2. 방법이 아닌 의도를 표현하는 추상적인 인터페이스 뒤로 모든 까다로운 메커니즘을 캡슐화해야한다. 도메인 퍼블릭 인터페이스에서는 관계와 규칙을 시행하는 방법이 아닌 이벤트와 규칙 그 자체만을 명시한다.
4. 함께모으기
    1. 디미터법칙, Tell Don’t Ask, 의모들 드러내는 인터페이스를 이해할 수 있는 좋은  방법중 하나는 이런원칙을 위반하는 코드의 모습을 살펴보는 것.
    2. 디미터의 법칙을 위반하는 설계는 인터페이스와 구현의 분리원칙을 위반하게 된다. 또한 객체의 내부가 노출되기 때문에 요구사항 변경에 취약해 질 수 있다.
    3.  **디미터의 법칙**은 객체 간의 협력을 설계할 때 캡슐화를 위반하는 매세지가 인터페이스에 포함되지 않도록 제한한다. **묻지 말고 시켜라** 원칙은 디미터법칙을 준수하는 협력을 만들기 위한 스타일을 제시한다. **의도를 드러내는 인터페이스** 원칙은 객체의 퍼블릭 인터페이스에 어떤 이름이 드러나야 하는지에 대한 지침을 제공함으로써 코드의 목적을 명확하게 커뮤니케이션할 수 있게 해준다.


### 원칙의 함정

- SW설계에 법칙이란 존재하지 않는다. 법칙에는 예외가 없지만 원칙에는 예외가 넘쳐난다.
- 원칙이 현재 상황에 부적합하다고 판단된다면 과감하게 원칙을 무시해야 한다. → 원칙을 아는 것보다 더 중요한것은 원칙이 유용하고 언제 유용하지 않은지를 판단하는 것이 중요하다.
- 묻지말고 시켜라, 디미터법칙을 준수하는 것이 항상 긍정적인 결과로만 귀결되지는 않는다.
- 위의 2가지 사항을 무작정으로 따른다면 애플리케이션은 응집도가 낮은 객체로 넘쳐난다

### 명령-쿼리 분리(Command-Query Separation) 원칙

- 퍼블릭 인터페이스에 오퍼레이션을 정의할 때 참고할 수 있는 지침을 제공한다.
- 루틴
    - 어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈